<div class="form-validation-demo">
  <div class="container">
    <h1>Form Validation Demo</h1>

    <div class="validation-info">
      <h2>Advanced Form Validation Techniques</h2>
      <p>This demo showcases various validation approaches in Template-Driven Forms:</p>
      <ul>
        <li>Built-in HTML5 validation</li>
        <li>Custom validation patterns</li>
        <li>Real-time validation feedback</li>
        <li>Password strength indicator</li>
        <li>Cross-field validation</li>
        <li>Custom error messages</li>
      </ul>
    </div>

    <div class="form-container">
      <h3>User Registration with Validation</h3>

      <form #validationForm="ngForm" (ngSubmit)="onSubmit()" class="validation-form">

        <!-- Username Field -->
        <div class="form-group">
          <label for="username">Username *</label>
          <input
            type="text"
            id="username"
            name="username"
            [(ngModel)]="user.username"
            required
            minlength="3"
            maxlength="20"
            pattern="^[a-zA-Z0-9_]+$"
            #username="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('username')"
            [class.is-valid]="isValid('username')"
            placeholder="Enter username (3-20 characters, alphanumeric only)"
          >
          <div class="invalid-feedback" *ngIf="hasError('username')">
            {{ getErrorMessage('username') }}
          </div>
          <div class="valid-feedback" *ngIf="isValid('username')">
            Username looks good!
          </div>
        </div>

        <!-- Email Field -->
        <div class="form-group">
          <label for="email">Email Address *</label>
          <input
            type="email"
            id="email"
            name="email"
            [(ngModel)]="user.email"
            required
            email
            #email="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('email') || hasCustomError('email')"
            [class.is-valid]="isValid('email') && !hasCustomError('email')"
            placeholder="Enter your email address"
          >
          <div class="invalid-feedback" *ngIf="hasError('email')">
            {{ getErrorMessage('email') }}
          </div>
          <div class="invalid-feedback" *ngIf="hasCustomError('email')">
            {{ getCustomErrorMessage('email') }}
          </div>
          <div class="valid-feedback" *ngIf="isValid('email') && !hasCustomError('email')">
            Email address is valid!
          </div>
        </div>

        <!-- Password Field with Strength Indicator -->
        <div class="form-group">
          <label for="password">Password *</label>
          <input
            type="password"
            id="password"
            name="password"
            [(ngModel)]="user.password"
            required
            minlength="8"
            (input)="checkPasswordStrength(user.password)"
            #password="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('password')"
            [class.is-valid]="isValid('password')"
            placeholder="Enter password (minimum 8 characters)"
          >

          <!-- Password Strength Indicator -->
          <div class="password-strength" *ngIf="user.password">
            <div class="strength-bar">
              <div
                class="strength-fill"
                [style.width.%]="getPasswordStrength()"
                [style.background-color]="getPasswordStrengthColor()"
              ></div>
            </div>
            <div class="strength-text">
              Password Strength: {{ getPasswordStrength() | number:'1.0-0' }}%
            </div>

            <!-- Password Requirements -->
            <div class="password-requirements">
              <div class="requirement" [class.met]="passwordStrength.hasLength">
                <span class="check">✓</span> At least 8 characters
              </div>
              <div class="requirement" [class.met]="passwordStrength.hasUppercase">
                <span class="check">✓</span> One uppercase letter
              </div>
              <div class="requirement" [class.met]="passwordStrength.hasLowercase">
                <span class="check">✓</span> One lowercase letter
              </div>
              <div class="requirement" [class.met]="passwordStrength.hasNumber">
                <span class="check">✓</span> One number
              </div>
                             <div class="requirement" [class.met]="passwordStrength.hasSpecial">
                 <span class="check">✓</span> One special character (&#64;$!%*?&)
               </div>
            </div>
          </div>

          <div class="invalid-feedback" *ngIf="hasError('password')">
            {{ getErrorMessage('password') }}
          </div>
        </div>

        <!-- Confirm Password Field -->
        <div class="form-group">
          <label for="confirmPassword">Confirm Password *</label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            [(ngModel)]="user.confirmPassword"
            required
            #confirmPassword="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('confirmPassword') || hasCustomError('confirmPassword')"
            [class.is-valid]="isValid('confirmPassword') && !hasCustomError('confirmPassword')"
            placeholder="Confirm your password"
          >
          <div class="invalid-feedback" *ngIf="hasError('confirmPassword')">
            {{ getErrorMessage('confirmPassword') }}
          </div>
          <div class="invalid-feedback" *ngIf="hasCustomError('confirmPassword')">
            {{ getCustomErrorMessage('confirmPassword') }}
          </div>
          <div class="valid-feedback" *ngIf="isValid('confirmPassword') && !hasCustomError('confirmPassword')">
            Passwords match!
          </div>
        </div>

        <!-- Age Field -->
        <div class="form-group">
          <label for="age">Age *</label>
          <input
            type="number"
            id="age"
            name="age"
            [(ngModel)]="user.age"
            required
            min="18"
            max="120"
            #age="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('age') || hasCustomError('age')"
            [class.is-valid]="isValid('age') && !hasCustomError('age')"
            placeholder="Enter your age (18-120)"
          >
          <div class="invalid-feedback" *ngIf="hasError('age')">
            {{ getErrorMessage('age') }}
          </div>
          <div class="invalid-feedback" *ngIf="hasCustomError('age')">
            {{ getCustomErrorMessage('age') }}
          </div>
        </div>

        <!-- Phone Field -->
        <div class="form-group">
          <label for="phone">Phone Number</label>
          <input
            type="tel"
            id="phone"
            name="phone"
            [(ngModel)]="user.phone"
            pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}"
            #phone="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('phone')"
            [class.is-valid]="isValid('phone')"
            placeholder="123-456-7890"
          >
          <div class="invalid-feedback" *ngIf="hasError('phone')">
            {{ getErrorMessage('phone') }}
          </div>
          <div class="valid-feedback" *ngIf="isValid('phone')">
            Phone number format is correct!
          </div>
        </div>

        <!-- Website Field -->
        <div class="form-group">
          <label for="website">Website URL</label>
          <input
            type="url"
            id="website"
            name="website"
            [(ngModel)]="user.website"
            #website="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('website') || hasCustomError('website')"
            [class.is-valid]="isValid('website') && !hasCustomError('website')"
            placeholder="https://example.com"
          >
          <div class="invalid-feedback" *ngIf="hasError('website')">
            {{ getErrorMessage('website') }}
          </div>
          <div class="invalid-feedback" *ngIf="hasCustomError('website')">
            {{ getCustomErrorMessage('website') }}
          </div>
          <div class="valid-feedback" *ngIf="isValid('website') && !hasCustomError('website')">
            Website URL is valid!
          </div>
        </div>

        <!-- Zip Code Field -->
        <div class="form-group">
          <label for="zipCode">Zip Code</label>
          <input
            type="text"
            id="zipCode"
            name="zipCode"
            [(ngModel)]="user.zipCode"
            pattern="[0-9]{5}"
            maxlength="5"
            #zipCode="ngModel"
            class="form-control"
            [class.is-invalid]="hasError('zipCode')"
            [class.is-valid]="isValid('zipCode')"
            placeholder="12345"
          >
          <div class="invalid-feedback" *ngIf="hasError('zipCode')">
            {{ getErrorMessage('zipCode') }}
          </div>
          <div class="valid-feedback" *ngIf="isValid('zipCode')">
            Zip code format is correct!
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button type="submit" class="btn btn-primary" [disabled]="validationForm.invalid">
            Submit Form
          </button>
          <button type="button" class="btn btn-secondary" (click)="resetForm()">
            Reset Form
          </button>
          <button type="button" class="btn btn-info" (click)="showValidationSummary()">
            Show Validation Summary
          </button>
        </div>
      </form>
    </div>

    <!-- Form State Display -->
    <div class="form-state">
      <h4>Form State Information</h4>
      <div class="state-grid">
        <div class="state-item">
          <strong>Valid:</strong> {{ validationForm.valid }}
        </div>
        <div class="state-item">
          <strong>Invalid:</strong> {{ validationForm.invalid }}
        </div>
        <div class="state-item">
          <strong>Pristine:</strong> {{ validationForm.pristine }}
        </div>
        <div class="state-item">
          <strong>Dirty:</strong> {{ validationForm.dirty }}
        </div>
        <div class="state-item">
          <strong>Touched:</strong> {{ validationForm.touched }}
        </div>
        <div class="state-item">
          <strong>Submitted:</strong> {{ validationForm.submitted }}
        </div>
      </div>
    </div>

    <!-- Form Data Display -->
    <div class="form-data">
      <h4>Current Form Data</h4>
      <pre>{{ user | json }}</pre>
    </div>
  </div>
</div>
